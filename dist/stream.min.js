var h=null;
define(function(){function u(a,c){a.push(c);return a}function p(a,c,i){for(var e=0;a!==h;)c.call(i,a.a,e),++e,a=j(a)}function j(a){return a.b(a.a)}function q(a,c,i){return c>=i?h:n(a[c],g(q,a,c+1,i))}function v(a,c){return r(c,a)}function r(a,c){return l(a,s(c))}function l(a,c){return a===h?c():k(a.a,g(l,j(a),c))}function n(a,c){var i;return{first:a,rest:function(){return void 0===i?i=c.apply(void 0,arguments):i}}}function k(a,c){return{first:a,rest:c}}function g(a){return 1===arguments.length?a:
a.bind.apply(a,arguments)}var w=Array.prototype.reduceRight,s=g(g,function(a){return a}),t=g(function c(i,e,b,d){if(e===h)return d;if(void 0===d)return c(1,j(e),b,e.a);p(e,function(c,e){d=b(d,c,e+i)});return d},0),x=g(function i(e,b,d,f){if(b===h)return f;var g=b.a,b=j(b);return b===h&&void 0===f?g:d(i(e+1,b,d,f),g,e)},0),y=g(function e(b,d,f,m){return d===h?d:n(f.call(m,d.a,b),g(e,b+1,j(d),f,m))},0),z=g(function b(d,f,m,l){for(;f!==h;){var k=f.a;if(m.call(f,k,d))return n(k,g(b,d+1,j(f),m,l));++d;
f=j(f)}return f},0);return{end:h,stream:k,memoStream:n,cons:function(b,d){return k(b,s(d))},concat:r,concatz:l,concata:function(){return 0===arguments.length?h:w.call(arguments,v)},from:function(b){return void 0===b?h:q(b,0,b.length)},first:function(b){return b.a},rest:j,isEmpty:function(b){return b===h},forEach:p,reduce:t,reduceRight:x,toArray:function(b){return t(b,u,[])},map:y,filter:z}});
